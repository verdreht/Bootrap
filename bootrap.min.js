let $$ = document.querySelectorAll.bind(document);

let wrap = function (toWrap, wrapper) {
    wrapper = wrapper || document.createElement('div');
    toWrap.parentNode.appendChild(wrapper);
    return wrapper.appendChild(toWrap);
};

//Bootrap initializer
window.addEventListener("load", function () {
    for (const elem of $$(".form-control")) {

        if(elem.getAttribute("type").toLowerCase() !== "checkbox") {

            let parent = elem.parentNode;
            let span = document.createElement("div");
            span.classList.add("text-border-bottom");
            parent.appendChild(span);

            elem.addEventListener("focus", function () {
                elem.nextElementSibling.style.width = "0";
                $(elem.nextElementSibling).stop().animate({
                    "background-color": "black",
                    "height": "2px",
                    "width": "100%",
                }, 200);
            });
            elem.addEventListener("blur", function () {
                $(elem.nextElementSibling).stop().animate({
                    "height": "1px",
                    "background-color": "#dbdbdb",
                }, 200);
            });
        }
    }
    for(const elem of $$(".form-control-button")) {
        elem.addEventListener("click", function () {
            if(!elem.innerHTML.includes("spinner")) {
                elem.innerHTML = "<span class=\"spinner-border spinner-border-sm\" role=\"status\" aria-hidden=\"true\"></span> Loading...";
            } else {
                $(elem).effect("shake");
            }
            setTimeout(function () {
                elem.blur();
            }, 200);
        })
    }
})
